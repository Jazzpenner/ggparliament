---
title: "Basic Parliament Plots"
author: "Zoe Meers"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)

source("../R/parliament_data.R")
source("../R/helper_funcs.R")
source("../R/draw_majoritythreshold.R")
source("../R/draw_legislaturelabels.R")
source("../R/theme_ggparliament.R")
library(dplyr)
library(magrittr)
library(ggplot2)
library(tidyr)
library(ggparliament)

```

## Introduction to `ggparliament`

`ggparliament` is a `ggplot2` extension for creating parliament plots. Although there are many parliament layouts around the world, we cannot create templates for all of them! Instead, we have created templated versions for the five most popular. They are:

- semicircle layouts

- horseshoe parliaments

- opposing bench-style parliaments

- the classroom layout

- a circular parliament.

We start with aggregate election returns by party. 
This package comes with recent election results from the UK, Australia, the United Sates, Russia, and Germany.

### Semicircle Parliament

If one wanted to plot the 115th Congress in the United States, they can run the following commands:

```{r}
us_congress <- election_data %>%
  filter(country == "USA" &
    year == 2016 &
    house == "Representatives")
head(us_congress)
```

We need to unravel the results to individual seats. To do this, we run:

```{r}
us_congress_semicircle <- parliament_data(election_data = us_congress,
  type = "semicircle",
  parl_rows = 10,
  party_seats = us_congress$seats)
head(us_congress_semicircle)
```

This data frame returns the x and y coordinates of each individual seat for a 10-row semicircle parliament. The user can take this data frame and plot by the x and y coordinates using `geom_parliament_seats()`. See as follows:

```{r, fig.width=6, fig.height=4}
us <- ggplot(us_congress_semicircle, aes(x, y, colour = party_short)) +
  geom_parliament_seats() + 
  theme_ggparliament() +
  labs(colour = NULL, 
       title = "United States Congress") +
  scale_colour_manual(values = us_congress_semicircle$colour, 
                      limits = us_congress_semicircle$party_short) 

us
```

`election_data` also provides party colour, abbreviated and full versions of the party name, as well as data for several election cycles for each country. 

### Horsehoe Parliament

The process is similar for other layouts -- just remember to change the 'type' qualifier in `parliament_data()` if you want to change the style!

```{r}
australia <- election_data %>%
  filter(country == "Australia" &
    house == "Representatives" &
    year == 2016) 

australia_horseshoe <- parliament_data(election_data = australia,
  party_seats = australia$seats,
  parl_rows = 4,
  type = "horseshoe")
```

```{r,fig.width=4, fig.height=4}
au <- ggplot(australia_horseshoe, aes(x, y, colour = party_short)) +
  geom_parliament_seats() + 
  theme_ggparliament() +
  labs(colour = NULL, 
       title = "Australian Parliament") +
  scale_colour_manual(values = australia$colour, 
                      limits = australia$party_short) + 
  theme(legend.position = 'bottom')

au
```

### Opposing Benches Parliament

We need to split the data into a left and right side for an opposing bench style parliament, then plot individually. Once we have done that, we can run `combine_opposing benches()` to get the full parliament. 


```{r, fig.height=6, fig.width = 6}
uk_17 <- election_data %>% 
  filter(country == "UK" & 
           year == "2017")

uk_17_left <- uk_17 %>% 
  filter(government == 0)

uk_17_right <- uk_17 %>% 
  filter(government == 1)


uk_17_left <- parliament_data(election_data = uk_17_left,
  party_seats =  uk_17_left$seats,
  parl_rows = 12,
  type = "opposing_benches")


uk_17_right <- parliament_data(election_data = uk_17_right,
  party_seats = uk_17_right$seats,
  parl_rows = 12,
  type = "opposing_benches")

right <- ggplot(uk_17_right, aes(x, y, colour = party_short)) +
  geom_parliament_seats() + 
  theme_ggparliament() +
  labs(colour = NULL) +
  scale_colour_manual(values = uk_17_right$colour, 
                      limits = uk_17_right$party_short) +
  theme(legend.position = 'right')


left <- ggplot(uk_17_left, aes(x, y, colour = party_short)) +
  geom_parliament_seats() + 
  theme_ggparliament() +
  labs(colour = NULL, 
       title = "UK parliament in 2017") +
  scale_colour_manual(values = uk_17_left$colour, 
                      limits = uk_17_left$party_short) +
  theme(legend.position = 'left') 

uk_parliament<- combine_opposingbenches(left = left, 
                                        right = right)
uk_parliament
```

### Classroom parliament

```{r}
russia_classroom <- election_data %>%
  filter(country == "Russia" &
    house == "Duma" &
    year == 2016) %>% 
  parliament_data(election_data = .,
                  party_seats = .$seats,
                  parl_rows = 11,
                  type = "classroom")
```

```{r,fig.width=4, fig.height=4}
rus <- ggplot(russia_classroom, aes(x, y, colour = party_short)) +
  geom_parliament_seats() +
  theme_ggparliament() +
  labs(
    colour = NULL,
    title = "Russian Duma") +
  scale_colour_manual(
    values = russia_classroom$colour,
    limits = russia_classroom$party_short) +
  theme(legend.position = "bottom")

rus
```


### Circle parliament

We have included the circle parliament as an option although we have yet to find a country that currently uses this parliamentary style!
To take the Russian data from above, we run:

```{r}
russia_circle <- election_data %>%
  filter(country == "Russia" &
    house == "Duma" &
    year == 2016) %>% 
  parliament_data(election_data = .,
    party_seats = .$seats,
    parl_rows = 11,
    type = "circle")
```

```{r,fig.width=4, fig.height=4}
rus2 <- ggplot(russia_circle, aes(x, y, colour = party_short)) +
  geom_parliament_seats() +
  theme_ggparliament() +
  labs(
    colour = NULL,
    title = "Russian Duma") +
  scale_colour_manual(
    values = russia_circle$colour,
    limits = russia_circle$party_short) +
  theme(legend.position = "bottom")

rus2
```


